<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jbp.service.dao.TankStoreRelationDao">

    <select id="getRelationList" resultType="com.jbp.common.response.TankStoreRelationListResponse">

        	select u.nickName , t.store_user_id ,t.created_time ,t.id from eb_tank_store_relation t
		left join eb_user u on u.id = t.store_user_id
		where t.tank_userId =  #{userId}

    </select>
	<select id="getAdminPageList" resultType="com.jbp.common.response.TankStoreRelationAdminListResponse">

		select t.id, t.tank_user_id  ,u.nickName,t.store_user_id,u2.nickName as storeusername,u2.phone ,t.created_time from eb_tank_store_relation t
		left join eb_user u on u.id = t.tank_user_id
		left join eb_user u2 on u2.id = t.store_user_id
		where 1=1

		<if test="username != null and username !=''">
			AND  ( u.nickName =  #{username} or u.id =  #{username} )
		</if>
		<if test="storeusername != null and storeusername !=''">
			AND  u2.nickName =   #{storeusername}
		</if>

		order by t.created_time desc
	</select>
</mapper>
